{"version":3,"file":"js/item-77a3c2a6.7302b9b3.js","mappings":"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","sources":["webpack://frrid/./src/utils/DateUtils.js","webpack://frrid/./src/views/ItemView.vue","webpack://frrid/./src/views/ItemView.vue?1409"],"sourcesContent":["import { DateTime } from \"luxon\";\n\nexport const SHORT_DATE_FORMAT = \"dd.MM.yyyy\";\n\nexport function normalizeDateTime(date) {\n  if (date instanceof Date) {\n    return DateTime.fromJSDate(date).setLocale(\"ru\");\n  }\n\n  if (typeof date === \"string\") {\n    return DateTime.fromISO(date).setLocale(\"ru\");\n  }\n\n  return date.setLocale(\"ru\");\n}\n\nexport function dateToFormat({ date, format = SHORT_DATE_FORMAT }) {\n  if (!date) {\n    return \"\";\n  }\n\n  const dateTime = normalizeDateTime(date);\n\n  return dateTime.toFormat(format);\n}\n","<template>\n  <AppLayout class=\"item-page\">\n    <template v-slot:default>\n      <FormsHeader class=\"item-page__forms-header\" :form-id=\"itemId\" />\n\n      <VTabs\n        :items=\"tabsItems\"\n        :current-tab=\"currentTab\"\n        @change=\"changeCurrentTab\"\n      />\n\n      <transition name=\"item-page__forms\" mode=\"out-in\">\n        <GeneralForm v-if=\"currentTab === 'general'\" />\n        <AuthorsForm\n          @success=\"showSuccess = true\"\n          v-else-if=\"currentTab === 'authors'\"\n        />\n        <ResourcesForm\n          v-else-if=\"currentTab === 'resources'\"\n          @success=\"showSuccess = true\"\n        />\n        <DatesForm v-else-if=\"currentTab === 'keyDates'\" />\n        <DisclosureForm v-else-if=\"currentTab === 'disclosure'\" />\n        <OrganizationsForm\n          v-else-if=\"currentTab === 'organizations'\"\n          @success=\"showSuccess = true\"\n        />\n        <TechnologyForm v-else-if=\"currentTab === 'technology' && isTechType\" />\n\n        <SourceCodeForm\n          v-else-if=\"currentTab === 'source-code' && !isTechType\"\n        />\n\n        <DescriptionForm\n          v-else-if=\"currentTab === 'description' && !isTechType\"\n        />\n      </transition>\n\n      <AddedModal :show=\"showSuccess\" />\n\n      <GeneralPositionModal\n        @submit=\"onSubmit\"\n        :show=\"showGeneralPosition\"\n        @close=\"showGeneralPosition = false\"\n      />\n\n      <CompleteModal :show=\"showComplete\" />\n    </template>\n\n    <template v-slot:footer v-if=\"hasEditForms\">\n      <ItemPageFooter\n        :complete=\"completed\"\n        @send=\"showGeneralPosition = true\"\n      />\n    </template>\n  </AppLayout>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from \"vuex\";\n\nimport VTabs from \"@/components/tabs/Tabs\";\nimport AppLayout from \"@/components/app/AppLayout\";\nimport DatesForm from \"@/components/forms/DatesForm\";\nimport AddedModal from \"@/components/modals/AddedModal\";\nimport GeneralForm from \"@/components/forms/GeneralForm\";\nimport FormsHeader from \"@/components/forms/FormsHeader\";\nimport AuthorsForm from \"@/components/authors/AuthorsForm\";\nimport CompleteModal from \"@/components/modals/CompleteModal\";\nimport ResourcesForm from \"@/components/resources/ResourcesForm\";\nimport ItemPageFooter from \"@/components/item-page/ItemPageFooter\";\nimport DisclosureForm from \"@/components/disclosure/DisclosureForm\";\nimport TechnologyForm from \"@/components/technology/TechnologyForm\";\nimport GeneralPositionModal from \"@/components/modals/GeneralPositionModal\";\nimport OrganizationsForm from \"@/components/organizations/OrganizationsForm\";\nimport {\n  FORMS_TABS_ITEMS,\n  FormsTabKeys,\n  FormsTabStatus,\n  FormStatus,\n  FormTypes,\n} from \"@/constants/FormConstants\";\nimport DescriptionForm from \"@/components/technology/DescriptionForm\";\nimport SourceCodeForm from \"@/components/technology/SourceCodeForm\";\n\nexport default {\n  name: \"ItemView\",\n  components: {\n    SourceCodeForm,\n    DescriptionForm,\n    VTabs,\n    DatesForm,\n    AppLayout,\n    AddedModal,\n    AuthorsForm,\n    FormsHeader,\n    GeneralForm,\n    ResourcesForm,\n    CompleteModal,\n    DisclosureForm,\n    TechnologyForm,\n    ItemPageFooter,\n    OrganizationsForm,\n    GeneralPositionModal,\n  },\n  computed: {\n    ...mapGetters(\"i18n\", [\"localize\"]),\n    ...mapGetters(\"application\", [\"getToken\"]),\n    ...mapGetters(\"formInfo\", [\"getFormType\", \"hasEditForms\"]),\n    ...mapGetters(\"general\", { generalFormStatus: \"getFormStatus\" }),\n    ...mapGetters(\"authors\", { authorsFormStatus: \"getFormStatus\" }),\n    ...mapGetters(\"dates\", { datesFormStatus: \"getFormStatus\" }),\n    ...mapGetters(\"technology\", { technologyFormStatus: \"getFormStatus\" }),\n    ...mapGetters(\"description\", { descriptionFormStatus: \"getFormStatus\" }),\n    ...mapGetters(\"organizations\", {\n      organizationsFormStatus: \"getFormStatus\",\n    }),\n    ...mapGetters(\"disclosure\", {\n      disclosureFormStatus: \"getFormStatus\",\n    }),\n    ...mapGetters(\"resources\", {\n      resourcesFormStatus: \"getFormStatus\",\n    }),\n    itemId() {\n      const id = Number(this.$route.params.id);\n\n      if (!Number.isNaN(id) && id !== 0) {\n        return id;\n      }\n\n      return FormStatus.Draft;\n    },\n    currentTab() {\n      return this.$route.query.tab || \"general\";\n    },\n    completed() {\n      const successGeneralForm =\n        this.generalFormStatus === FormsTabStatus.Filled;\n      const successAuthorsForm =\n        this.authorsFormStatus === FormsTabStatus.Filled;\n      const successDatesForm = this.datesFormStatus === FormsTabStatus.Filled;\n      const successTechnologyForm =\n        this.technologyFormStatus === FormsTabStatus.Filled;\n      const successOrganizationsForm =\n        this.organizationsFormStatus === FormsTabStatus.Filled;\n      const successDisclosureForm =\n        this.disclosureFormStatus === FormsTabStatus.Filled;\n      const successResourcesForm =\n        this.resourcesFormStatus === FormsTabStatus.Filled;\n      const successDescriptionForm = !this.isTechType\n        ? this.descriptionFormStatus === FormsTabStatus.Filled\n        : true;\n\n      return (\n        successDatesForm &&\n        successGeneralForm &&\n        successAuthorsForm &&\n        successResourcesForm &&\n        successDisclosureForm &&\n        successTechnologyForm &&\n        successOrganizationsForm &&\n        successDescriptionForm\n      );\n    },\n    tabStatuses() {\n      return {\n        [FormsTabKeys.KeyDates]: this.datesFormStatus,\n        [FormsTabKeys.General]: this.generalFormStatus,\n        [FormsTabKeys.Authors]: this.authorsFormStatus,\n        [FormsTabKeys.Resources]: this.resourcesFormStatus,\n        [FormsTabKeys.Technology]: this.technologyFormStatus,\n        [FormsTabKeys.Disclosure]: this.disclosureFormStatus,\n        [FormsTabKeys.SourceCode]: this.technologyFormStatus,\n        [FormsTabKeys.Description]: this.descriptionFormStatus,\n        [FormsTabKeys.Organizations]: this.organizationsFormStatus,\n      };\n    },\n    isTechType() {\n      return this.getFormType === FormTypes.Tech;\n    },\n    tabsItems() {\n      let list = FORMS_TABS_ITEMS.map((x) => ({\n        ...x,\n        title: this.localize[x.title].text,\n      })).slice();\n\n      if (this.isTechType) {\n        list.splice(FORMS_TABS_ITEMS.length - 2, 2);\n      } else {\n        list.splice(FORMS_TABS_ITEMS.length - 3, 1);\n      }\n\n      return list.map((x) => ({\n        ...x,\n        status: this.tabStatuses[x.key] || FormsTabStatus.NotFilled,\n      }));\n    },\n  },\n  data() {\n    return {\n      showSuccess: false,\n      showComplete: false,\n      showGeneralPosition: false,\n    };\n  },\n  watch: {\n    showSuccess(nextState, prevState) {\n      if (nextState !== prevState) {\n        const timout = setTimeout(() => {\n          this.showSuccess = false;\n\n          clearTimeout(timout);\n        }, 2000);\n      }\n    },\n    isTechType(nextState, prevState) {\n      if (\n        nextState !== prevState &&\n        (this.currentTab === FormsTabKeys.Description ||\n          this.currentTab === FormsTabKeys.SourceCode)\n      ) {\n        this.changeCurrentTab(FormsTabKeys.Technology);\n      } else if (\n        nextState !== prevState &&\n        this.currentTab === FormsTabKeys.Technology\n      ) {\n        this.changeCurrentTab(FormsTabKeys.SourceCode);\n      }\n    },\n    showComplete(nextState, prevState) {\n      if (nextState && !prevState) {\n        const timout = setTimeout(() => {\n          this.showComplete = false;\n\n          clearTimeout(timout);\n        }, 2000);\n      }\n    },\n  },\n  methods: {\n    ...mapActions(\"authors\", [\"getAuthors\"]),\n    changeCurrentTab(tab) {\n      this.$router.replace({ ...this.$route, query: { tab } });\n    },\n    onSubmit() {\n      this.showGeneralPosition = false;\n      this.showComplete = true;\n    },\n  },\n  mounted() {\n    if (!this.getToken) {\n      this.$router.replace(\"/\");\n    }\n\n    this.getAuthors();\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import \"~@/assets/styles/mixins.scss\";\n\n.item-page__forms-header {\n  margin: 19px 0 29px;\n}\n\n.item-page__forms-enter-active,\n.item-page__forms-leave-active {\n  @include transition(opacity);\n}\n\n.item-page__forms-enter-from,\n.item-page__forms-leave-to {\n  opacity: 0;\n}\n</style>\n","import { render } from \"./ItemView.vue?vue&type=template&id=1daa1544&scoped=true\"\nimport script from \"./ItemView.vue?vue&type=script&lang=js\"\nexport * from \"./ItemView.vue?vue&type=script&lang=js\"\n\nimport \"./ItemView.vue?vue&type=style&index=0&id=1daa1544&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/victorzimnikov/projects/javascript/frrid/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1daa1544\"]])\n\nexport default __exports__"],"names":["SHORT_DATE_FORMAT","normalizeDateTime","date","Date","DateTime","setLocale","dateToFormat","format","dateTime","toFormat","_createBlock","_component_AppLayout","class","_createSlots","default","_createVNode","_component_FormsHeader","$options","_component_VTabs","items","onChange","_Transition","name","mode","_component_GeneralForm","key","_component_AuthorsForm","onSuccess","$data","_component_ResourcesForm","_component_DatesForm","_component_DisclosureForm","_component_OrganizationsForm","_component_TechnologyForm","_component_DescriptionForm","_component_SourceCodeForm","_component_AddedModal","show","_component_GeneralPositionModal","onSubmit","onClose","_component_CompleteModal","_ctx","_component_ItemPageFooter","complete","onSend","components","SourceCodeForm","DescriptionForm","VTabs","DatesForm","AppLayout","AddedModal","AuthorsForm","FormsHeader","GeneralForm","ResourcesForm","CompleteModal","DisclosureForm","TechnologyForm","ItemPageFooter","OrganizationsForm","GeneralPositionModal","computed","mapGetters","generalFormStatus","authorsFormStatus","datesFormStatus","technologyFormStatus","descriptionFormStatus","organizationsFormStatus","disclosureFormStatus","resourcesFormStatus","itemId","id","Number","this","$route","params","isNaN","FormStatus","currentTab","query","tab","completed","successGeneralForm","FormsTabStatus","successAuthorsForm","successDatesForm","successTechnologyForm","successOrganizationsForm","successDisclosureForm","successResourcesForm","successDescriptionForm","isTechType","tabStatuses","FormsTabKeys","getFormType","FormTypes","tabsItems","list","FORMS_TABS_ITEMS","x","title","localize","text","slice","splice","map","status","data","showSuccess","showComplete","showGeneralPosition","watch","nextState","prevState","timout","setTimeout","clearTimeout","changeCurrentTab","methods","mapActions","$router","replace","mounted","getToken","getAuthors","__exports__","render"],"sourceRoot":""}